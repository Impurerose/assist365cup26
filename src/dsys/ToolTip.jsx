/**
 * ToolTip Component
 *
 * A flexible tooltip component that displays contextual information on hover/focus.
 * Adapted from @a365/ui-core for standalone use.
 *
 * @example
 * import ToolTip from './dsys/ToolTip';
 * import { Info } from '@phosphor-icons/react';
 *
 * // Con contenido personalizado
 * <ToolTip content="Esta es una ayuda contextual">
 *   <Info size={20} />
 * </ToolTip>
 *
 * // Con ícono por defecto
 * <ToolTip content="Información adicional" />
 *
 * // Sin flecha
 * <ToolTip content="Tooltip sin flecha" arrow={false}>
 *   <Info size={20} />
 * </ToolTip>
 */

import React, { useState, useRef } from 'react';

const ToolTip = ({ content, children, className, arrow = true }) => {
  const [visible, setVisible] = useState(false);
  const idRef = useRef('tooltip-' + Math.random().toString(36).slice(2, 9));

  const containerClass = `${
    className ? className + ' ' : ''
  }relative inline-flex items-center`;

  return (
    <span
      className={containerClass}
      onMouseEnter={() => setVisible(true)}
      onMouseLeave={() => setVisible(false)}
      onFocus={() => setVisible(true)}
      onBlur={() => setVisible(false)}
    >
      <button
        type="button"
        aria-describedby={idRef.current}
        className="bg-transparent p-0 border-0 cursor-pointer"
      >
        {children || (
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="21"
            height="21"
            viewBox="0 0 21 21"
            fill="none"
            aria-hidden="true"
          >
            <path
              d="M8.25 6C8.25 5.70333 8.33798 5.41332 8.5028 5.16664C8.66762 4.91997 8.90189 4.72771 9.17598 4.61418C9.45007 4.50065 9.75167 4.47094 10.0426 4.52882C10.3336 4.5867 10.6009 4.72956 10.8107 4.93934C11.0204 5.14912 11.1633 5.41639 11.2212 5.70736C11.2791 5.99834 11.2494 6.29994 11.1358 6.57402C11.0223 6.84811 10.83 7.08238 10.5834 7.2472C10.3367 7.41203 10.0467 7.5 9.75 7.5C9.35218 7.5 8.97065 7.34196 8.68934 7.06066C8.40804 6.77936 8.25 6.39782 8.25 6ZM20.25 10.125C20.25 12.1275 19.6562 14.0851 18.5436 15.7501C17.4311 17.4152 15.8498 18.7129 13.9997 19.4793C12.1496 20.2456 10.1138 20.4461 8.14971 20.0555C6.18566 19.6648 4.38156 18.7005 2.96555 17.2845C1.54954 15.8685 0.585229 14.0643 0.194554 12.1003C-0.196122 10.1362 0.00438702 8.10043 0.770724 6.25033C1.53706 4.40023 2.83481 2.81892 4.49986 1.70637C6.1649 0.593821 8.12247 0 10.125 0C12.8094 0.00297771 15.383 1.07067 17.2812 2.96883C19.1793 4.86699 20.247 7.4406 20.25 10.125ZM18 10.125C18 8.56747 17.5381 7.04492 16.6728 5.74988C15.8075 4.45485 14.5776 3.44549 13.1386 2.84945C11.6997 2.25341 10.1163 2.09746 8.58867 2.40132C7.06107 2.70517 5.65788 3.4552 4.55654 4.55653C3.4552 5.65787 2.70518 7.06106 2.40132 8.58866C2.09746 10.1163 2.25341 11.6997 2.84945 13.1386C3.44549 14.5776 4.45485 15.8075 5.74989 16.6728C7.04493 17.5381 8.56748 18 10.125 18C12.2129 17.9978 14.2146 17.1674 15.691 15.691C17.1674 14.2146 17.9978 12.2129 18 10.125ZM11.25 13.5637V10.5C11.25 10.0027 11.0525 9.52581 10.7008 9.17417C10.3492 8.82254 9.87229 8.625 9.375 8.625C9.10933 8.6246 8.85208 8.71825 8.64883 8.88935C8.44558 9.06044 8.30944 9.29795 8.26452 9.55981C8.21961 9.82166 8.26881 10.091 8.40343 10.32C8.53804 10.5491 8.74938 10.7231 9 10.8113V13.875C9 14.3723 9.19755 14.8492 9.54918 15.2008C9.90081 15.5525 10.3777 15.75 10.875 15.75C11.1407 15.7504 11.3979 15.6568 11.6012 15.4857C11.8044 15.3146 11.9406 15.077 11.9855 14.8152C12.0304 14.5533 11.9812 14.284 11.8466 14.055C11.712 13.8259 11.5006 13.6519 11.25 13.5637Z"
              fill="#57B7FF"
            />
          </svg>
        )}
      </button>

      {visible && content && (
        <div
          id={idRef.current}
          role="tooltip"
          className="absolute bg-bg-alt-secondary text-white p-4 rounded-xl text-[13px] w-[300px] z-50 shadow-lg font-light"
          style={{ left: '50px', top: '50%', transform: 'translateY(-50%)' }}
        >
          {arrow && (
            <span
              aria-hidden="true"
              style={{
                position: 'absolute',
                left: '-14px',
                top: '50%',
                transform: 'translateY(-50%)',
                width: 0,
                height: 0,
                borderTop: '10px solid transparent',
                borderBottom: '10px solid transparent',
                borderRight: '19px solid #0059BA',
                pointerEvents: 'none',
              }}
            />
          )}

          {content}
        </div>
      )}
    </span>
  );
};

export default ToolTip;
